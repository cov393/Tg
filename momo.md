Чтобы успешно выполнить это задание, тебе нужно протестировать и подтвердить, что Azure Monitoring Agent (AMA) заменяет OMS (Operations Management Suite) агент на твоих серверах в Azure до завершения поддержки OMS, которая официально прекращается 30 ноября 2024 года. Вот как можно подойти к задаче:

1. Изучение изменений и плана замены OMS на AMA:

Цель: Понять, что изменится при переходе с OMS на AMA.

Шаги:

Ознакомься с документацией по AMA, включая ссылки на коммуникации и статус развертывания, которые тебе предоставили (они помогут лучше понять суть изменений и план действий).

Убедись, что знаешь ключевые отличия AMA от OMS, например:

AMA поддерживает multi-homing (подключение к нескольким Log Analytics рабочим областям).

AMA использует Data Collection Rules (DCR) для улучшения настройки логов и телеметрии.


Найди актуальный статус развертывания AMA в твоей инфраструктуре (см. ссылку в тексте: Rollout update).



2. Идентификация зависимости от OMS:

Цель: Определить, где в инфраструктуре еще используется OMS и где его нужно заменить на AMA.

Шаги:

С помощью Azure Portal проверь, какие серверы и сервисы еще используют OMS.

Для этого можно использовать Azure Monitor или Log Analytics, чтобы увидеть, какие агенты установлены на виртуальных машинах (VMs) и скейлсетах.

Если есть системы с кастомными логами, это важно отметить, так как OMS будет заменен AMA и тебе нужно будет проверить совместимость кастомных логов с новым агентом.



3. Тестирование и проверка AMA:

Цель: Установить AMA на серверы и убедиться, что он работает правильно, заменяя OMS.

Шаги:

Если серверы еще работают с OMS, установи AMA параллельно через Azure Policy (как указано в твоем задании).

Проверь, как работает логирование и мониторинг после замены, а также как данные передаются в Log Analytics.

Если у тебя есть кастомные логи, особое внимание удели их проверке — убедись, что все данные корректно собираются с помощью AMA, особенно для Unix-серверов (как указано в тексте, были проблемы с недостающими полями для кастомных логов).



4. Документирование результатов:

После тестирования нужно задокументировать процесс развертывания и результаты.

Отметь любые проблемы, с которыми ты столкнулся, и как они были решены (например, проблемы с кастомными логами на Unix или сложности с масштабируемыми наборами).


С кем связаться:

CMAE Team — это команда, которая отвечает за развертывание и поддержку AMA. Если возникнут проблемы с развертыванием, ты можешь обратиться к ним за помощью.

SRE команда (Site Reliability Engineering), если тебе понадобится помощь с настройкой или тестированием AMA, особенно если ты работаешь с кастомными логами.

Если есть вопросы по конкретным серверам или службам, работающим под твоей ответственностью, можно связаться с другими инженерами или командами, которые управляют этими системами.


Как протестировать:

Установи AMA на серверы (VMs или скейлсеты) через Azure Policy или вручную, следуя инструкциям по развертыванию (ссылки в твоем задании).

Убедись, что логи и метрики продолжают корректно собираться и передаваться в Log Analytics.

Если есть кастомные логи, убедись, что они корректно передаются через Data Collection Rules (DCR).

Проверь работу алертинга, если он был настроен для OMS, и убедись, что данные, собираемые AMA, корректно передаются в систему управления инцидентами, например, в BigPanda.


Важные моменты:

OMS продолжит работать до февраля 2025 года, но без поддержки от Microsoft, за исключением исправлений уязвимостей безопасности.

AMA уже развернут на всех новых серверах, но если ты тестируешь на существующих серверах, тебе нужно будет убедиться, что агент заменен и работает корректно.

Кастомные логи на Unix-серверах требуют особого внимания из-за возможных проблем с полями данных.


Если тебе нужно больше деталей по конкретным аспектам задания, я помогу их уточнить!

